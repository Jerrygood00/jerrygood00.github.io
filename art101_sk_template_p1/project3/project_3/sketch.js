//////////////////////////////////////////
///////////////Car chase//////////////////
//////////// Winson, Yun Che////////////
//////////////////////////////////////////


var wall;
var wall2;
var wall3;
var wall4;
var car;
var car2;
var carImage, carflameImage, message1Image, message2Image, message3Image, message4Image,
message5Image, message6Image, message7Image, message8Image, message9Image, endImage, backgroundImage, laneImage;
var carImage2;
var message1;
var message2;
var message3;
var message4;
var message5;
var message6;
var message7;
var message8;
var message9;
var MARGIN = 40;
var slider;
var slider2;
var song;
var song2;
var song3;

//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////

function preload() {

  //////////////////////////////////////////
  /////////// Load sound file //////////////
  //////////////Yun Che//////////////
  //////////////////////////////////////////
  song = loadSound('Supercar acceleration sounds HD.mp3');
  song2 = loadSound('Initial D - Running In The 90s [LYRICS].mp3');
  song3 = loadSound('Gta 5 Wasted Sound effect.mp3');
}

//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////

function setup() {

createCanvas(1300,530);



//////////////////////////////////////////
///////////song 1 2 looping //////////////
//////////////Yun Che/////////////////////
//////////////////////////////////////////
song.loop();
song2.loop();
//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////



//////////////////////////////////////////
//////////// load image file /////////////
/////////////Winson//////////////////////////
//////////////////////////////////////////
carImage = loadImage("cop.png");
carImage2= loadImage("car2.png");
carflameImage= loadImage("carflame0001.png");
wallImage= loadImage("wall.png");
wall2Image=loadImage("wall2.png");
wall3Image=loadImage("vwall3.png");
wall4Image=loadImage("vwall4.png");

//////////////////////////////////////////
///////////////Yun Che////////////////////
//////////////////////////////////////////
message1Image = loadImage("message1.png");
message2Image = loadImage("message2.png");
message3Image = loadImage("message3.png");
message4Image = loadImage("message4.png");
message5Image = loadImage("message5.png");
message6Image = loadImage("message6.png");
message7Image = loadImage("message7.png");
message8Image = loadImage("message8.png");
message9Image = loadImage("message9.png");

//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////




//////////////////////////////////////////
/////////////Winson//////////////////////////
//////////////////////////////////////////
backgroundImage = loadImage("background.png");
laneImage = loadImage("lane.png");
endImage = loadImage("end.png");
//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////




//////////////////////////////////////////
/////////// sprite wall blocks ///////////
/////////////Winson//////////////////////////
//////////////////////////////////////////

wall= createSprite(0,-20);
wall.scale= 1.1;
wall.addImage("normal",wallImage);

wall2= createSprite(0,550);
wall2.scale= 1.1;
wall2.addImage("normal",wall2Image);

wall3= createSprite(1330,0);
wall3.scale= 1.1;
wall3.addImage("normal",wall3Image);

wall4= createSprite(-30,0);
wall4.scale= 1.1;
wall4.addImage("normal",wall4Image);

//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////


//////////////////////////////////////////
//////////// sprite car 1 ////////////////
/////////////Winson//////////////////////////
//////////////////////////////////////////
car = createSprite(30, 500);
car.addImage("normal", carImage);
car.addAnimation("thrust", "carflame0001.png");
car.scale= 0.085;
car.maxSpeed = 20;
car.friction = .01;
car.setCollider("rectangle",0,0,900,400 );

//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////



//////////////////////////////////////////
//////// spirte message(#) blocks ////////
///////////////Yun Che////////////////////
//////////////////////////////////////////
message1= createSprite(random(1000), random(500));
message1.scale= 1.5;
message1.addImage("normal",message1Image);

message2= createSprite(random(1000), random(500));
message2.scale= 1.5;
message2.addImage("normal",message2Image);

message3= createSprite(random(1000), random(500));
message3.scale= 1.5;
message3.addImage("normal",message3Image);

message4= createSprite(random(1000), random(500));
message4.scale= 1.5;
message4.addImage("normal",message4Image);

message5= createSprite(random(1000), random(500));
message5.scale= 1.5;
message5.addImage("normal",message5Image);

message6= createSprite(random(1000), random(500));
message6.scale= 1.5;
message6.addImage("normal",message6Image);

message7= createSprite(random(1000), random(500));
message7.scale= 1.5;
message7.addImage("normal",message7Image);

message8= createSprite(random(1000), random(500));
message8.scale= 1.5;
message8.addImage("normal",message8Image);

message9= createSprite(random(1000), random(500));
message9.scale= 1.3;
message9.addImage("normal",message9Image);

//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////



//////////////////////////////////////////
///////////// spirte car 2 ///////////////
/////////////Winson//////////////////////////
//////////////////////////////////////////

car2 = createSprite(1270, 30);
car2.addImage("normal", carImage2);
car2.addAnimation("thrust", "carflame0001.png");
car2.scale= 0.08;
car2.maxSpeed = 20;
car2.friction = .01;
car2.setCollider("rectangle",0,0,900,400 );

// car2.addImage("normal", carImage2);
// car2.addAnimation("thrust", "carflame0001.png");


//////////////////////////////////////////////
//////////////////////////////////////////////
//////////////////////////////////////////////



////////////////////////////////////////////////////////////////////
////Message appears and reappear when passed the border /////////////
/////////////Winson////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////
for(var i = 0; i<9; i++) {
  var ang = random(360);
  var px = width/2 + 1000 * cos(radians(ang));
  var py = height/2+ 1000 * sin(radians(ang));
  }
//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////


  // image(backgroundImage,0,height/2);



//////////////////////////////////////////
///////////// slider on top //////////////
//////////////Yun Che/////////////////////
//////////////////////////////////////////
  slider = createSlider(0, 255, 127);
  slider.position(60,111);
  slider2 = createSlider(0, 400, 400);
  slider2.position(70,135);
}

//////////////////////////////////////////
//////////////////////////////////////////

function draw() {

  background(0);

//////////////////////////////////////////
///// volume controls song 1 ////////////
//////////////Yun Che////////////////////
//////////////////////////////////////////
  var volume = map(slider.value(), 0, width, 0, 1);
  volume = constrain(volume, 0, 1);
  song.amp(volume);

//////////////////////////////////////////
////// volume controls song 2 ///////////
//////////////Yun Che////////////////////
//////////////////////////////////////////
  var volume = map(slider2.value(), 0, width, 0, 1);
  volume = constrain(volume, 0, 1);
  song2.amp(volume);

//////////////////////////////////////////
//////////////////////////////////////////



//////////////////////////////////////////
////// road background image ////////
/////////////Winson/////////////
//////////////////////////////////////////
  image(backgroundImage,-10,height/2);
  image(laneImage,-10,130);
  image(laneImage,-10,400);

//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////
  // fill(255);
  // textAlign(CENTER);
  // text("Player 1 Controls: Arrow Keys, Nitrous: M  ", width/2, 20);
  // text("Player 2 Controls: A W D, Nitrous: V ", width/2, 40);

//////////////////////////////////////////
//////////// ALL sprite borders //////////
/////////////Winson//////////////////////////
//////////////////////////////////////////

  for(var i=0; i<allSprites.length; i++) {
  var s = allSprites[i];
  if(s.position.x<-MARGIN) s.position.x = width+MARGIN;
  if(s.position.x>width+MARGIN) s.position.x = -MARGIN;
  if(s.position.y<-MARGIN) s.position.y = height+MARGIN;
  if(s.position.y>height+MARGIN) s.position.y = -MARGIN;
  }
//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////


/////////////////////////////////////////////
//////////// sprite applies (int) ////////////
////////////////Winson//////////////////////////
//////////////////////////////////////////////


car.bounce(car2,hit);
car2.bounce(car);


car.collide(wall);
car.collide(wall2);
car.collide(wall3);
car.collide(wall4);
car.collide(car2);


car2.collide(wall);
car2.collide(wall2);
car2.collide(wall3);
car2.collide(wall4);
car2.collide(car);
//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////



//////////////////////////////////////////
//////////// sprite applies (int) ////////
////////////////Yun Che///////////////////
//////////////////////////////////////////
car.bounce(message1);
car.bounce(message2);
car.bounce(message3);
car.bounce(message4);
car.bounce(message5);
car.bounce(message6);
car.bounce(message7);
car.bounce(message8);
car.bounce(message9);


car2.bounce(message1);
car2.bounce(message2);
car2.bounce(message3);
car2.bounce(message4);
car2.bounce(message5);
car2.bounce(message6);
car2.bounce(message7);
car2.bounce(message8);
car2.bounce(message9);

//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////

       // if(car.bounce(car2)){
       //   text('hahahahaha',100,500);
       // }
       // else {
       //   text('haha1234',500,200);
       // }



///////////////////////////////////////
//////////Key pressed controls/////////
//////////// Winson ////////////
///////////////////////////////////////
  if(keyDown("j")){
    car.rotation -= 4;
  }
  if(keyDown("l")){
    car.rotation += 4;
  }
  if(keyDown("i")){
car.addSpeed(.1, car.rotation);
}
  if(keyDown("a")){
    car2.rotation -= 4;
  }
  if(keyDown("d")){
    car2.rotation += 4;
  }
  if(keyDown("w")){
    car2.addSpeed(.1, car2.rotation);

    }
  else{
    car.changeAnimation("normal");
    car2.changeAnimation("normal");
}
//   if(keyDown("m")){
//   car.addSpeed(.12,car.rotation)
//   car.changeImage("carflameImage");
// }
//
//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////



//////////////////////////////////////////
/////////////Nitrous controls//////////
//////////// Winson ////////////
///////////////////////////////////////
  if(keyDown("v")){

  car2.addSpeed(.12,car2.rotation)
  car2.changeImage("carflameImage");
}
  drawSprites();

}
//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////


//////////////////////////////////////////
////////////Ending image//////////////////
//////////// Winson, YunChe /////////////
//////////////////////////////////////////

function hit(car, car2){
car2.remove();
image(endImage, 5, -40);
song.pause();
song2.pause();
song3.play();
noDraw();
}
//////////////////////////////////////////
//////////////////////////////////////////
//////////////////////////////////////////
